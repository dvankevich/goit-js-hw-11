{"version":3,"file":"commonHelpers2.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import response from '../testdata/cats.json';\nimport empty from '../testdata/empty.json';\nimport { getApiKey } from './crypto';\n\n// BUGs\n// цікава поведінка з запитами кирилицею, можливо через перекодування.\n// запит \"кіт\" перетворюється на %D0%BA%D1%96%D1%82 і виводить зовсім не котів.\n// simpleLightBox після такого запиту веде себе некорректно.\n// Забрав encodeURIComponent  - \"кіт\" видає релевантний пошук, а от \"чорна кішка\" вже ні.\n//\n// також в консолі видає попередження:\n// Source map error: No sources are declared in this source map.\n// Resource URL: http://localhost:5173/@fs/home/dima/01FullStack/02js/goit-js-hw-11/node_modules/.vite/deps/chunk-CQXHTUV2.js?v=729a0ab5\n// Source Map URL: chunk-CQXHTUV2.js.map\n\n/**\n *\n * @param {string} searchTerm\n * @returns JSON object\n */\nexport function getImages(searchTerm) {\n  const options = {\n    method: 'GET',\n    headers: {\n      Accept: 'application/json',\n    },\n  };\n  const apiParams = new URLSearchParams({\n    key: getApiKey(),\n    //q: encodeURIComponent(searchTerm), // працює і без того\n    q: searchTerm,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n  });\n\n  const queryUrl = `https://pixabay.com/api/?${apiParams}`;\n  //console.log(queryUrl);\n  return fetch(queryUrl)\n    .then(response => {\n      if (!response.ok) {\n        throw new Error(response.status);\n      }\n      return response.json();\n    })\n    .catch(error => console.log('Error fetching photos:', error));\n}\n\nexport function getImagesTest(searchTerm) {\n  return fakeFetch(searchTerm)\n    .then(searchTerm => {\n      console.log(searchTerm, 'in getImagesTest');\n      if (searchTerm === 'test') {\n        return empty;\n      } else {\n        return response;\n      }\n    })\n    .catch(error => {\n      console.error(error);\n      return empty;\n    });\n}\n\nconst fakeFetch = searchTerm => {\n  return new Promise((resolve, reject) => {\n    const timeout = Math.round(Math.random() * 2000);\n    console.log(\n      `emulate fetch search result with timeout: ${timeout} for search term: ${searchTerm}`\n    );\n    setTimeout(() => {\n      if (!(searchTerm === 'error')) {\n        resolve(searchTerm);\n      } else {\n        reject('http error in reject');\n      }\n    }, timeout);\n  });\n};\n","function getItemMarkdown(item) {\n  // webformatURL — посилання на маленьке зображення для списку карток у галереї\n  // largeImageURL — посилання на велике зображення для модального вікна\n  // tags — рядок з описом зображення. Підійде для атрибута alt\n  // likes — кількість вподобайок\n  // views — кількість переглядів\n  // comments — кількість коментарів\n  // downloads — кількість завантажень\n  return `\n  <li class=\"gallery-item\">\n    <a href=\"${item.largeImageURL}\"\n      class=\"galery-item-image-link\">\n      <img class=\"galery-item-image\"\n        src=\"${item.webformatURL}\"\n        alt=\"${item.tags}\" />\n    </a>\n    <ul class=\"image-info\">\n      <li class=\"image-info-item\">\n        <p class=\"info-item-caption\">Likes</p>\n        <p class=\"info-item-value\">${item.likes}</p>\n      </li>\n      <li class=\"image-info-item\">\n        <p class=\"info-item-caption\">Views</p>\n        <p class=\"info-item-value\">${item.views}</p>\n\n      </li>\n      <li class=\"image-info-item\">\n        <p class=\"info-item-caption\">Comments</p>\n        <p class=\"info-item-value\">${item.comments}</p>\n      </li>\n      <li class=\"image-info-item\">\n        <p class=\"info-item-caption\">Downloads</p>\n        <p class=\"info-item-value\">${item.downloads}</p>\n      </li>\n    </ul>\n  </li>\n`;\n}\n\n/**\n *\n * @param {Array} images array\n * @returns HTML markdown for gallery\n */\nexport function getGalleryMarkdown(images) {\n  return images.map(getItemMarkdown).join('');\n}\n\n/**\n *\n * @param {Object} gallery gallery DOM object\n * @param {String} markdown HTML markdown for gallery\n */\nexport function drawGallery(gallery, markdown) {\n  gallery.innerHTML = markdown;\n}\n","import { getImages } from './js/pixabay-api';\nimport { getImagesTest } from './js/pixabay-api';\nimport { getGalleryMarkdown, drawGallery } from './js/render-functions';\nimport SimpleLightbox from 'simplelightbox';\n// Додатковий імпорт стилів\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\n// Додатковий імпорт стилів\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst iziCommon = {\n  message: 'Common message',\n  theme: 'dark',\n  position: 'topRight',\n  titleColor: '#fff',\n  titleSize: '16px',\n  titleLineHeight: '1.5',\n  messageColor: '#fff',\n  messageSize: '16px',\n  messageLineHeight: '1.5',\n  imageWidth: 24,\n};\n\nconst iziError = {\n  ...iziCommon,\n  color: '#ef4040',\n  iconUrl: 'error-icon.svg', // зображення має бути у папці public\n};\n\nconst iziWarning = {\n  ...iziCommon,\n  title: 'Warning',\n  color: '#ffa000',\n  iconUrl: 'caution-icon.svg',\n};\n\nconst loadMessageMarkdown =\n  '<li class=\"load-message\">Loading images, please wait...</li>';\nconst myGallery = document.querySelector('.gallery');\nconst searchButton = document.querySelector('.search-button');\nconst searchInput = document.querySelector('.search-input');\nconst simpleLightBox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n  overlayOpacity: 0.8,\n});\n\nsearchButton.addEventListener('click', searchButtonHandler);\n\nfunction searchButtonHandler(event) {\n  event.preventDefault();\n  let searchTerm = String(searchInput.value.trim());\n  searchTerm = searchTerm.replace(/[*]/g, ''); // видалення спецсимволів\n  let galleryMarkdown = '';\n  let images = '';\n  // console.log(searchTerm.length);\n\n  if (!searchTerm || searchTerm.length < 3) {\n    iziToast.warning({\n      ...iziWarning,\n      message: 'Enter data for search, please. Min. 3 symbols.',\n    });\n    // console.log('Enter data for search, please. Min. 3 symbols.');\n    searchInput.value = ''; // clear input\n    drawGallery(myGallery, ''); // clear gallery\n    return;\n  }\n\n  console.log(`fetch data from backend with search term: ${searchTerm}`);\n  drawGallery(myGallery, loadMessageMarkdown);\n\n  // -----\n  //images = getImages(searchTerm);\n  //console.log(images.hits);\n  //\n  //console.log(getImages(searchTerm));\n\n  getImages(searchTerm)\n    .then(images => {\n      if (images.hits.length === 0) {\n        iziToast.error({\n          ...iziError,\n          message:\n            'Sorry, there are no images matching<br> your search query. Please, try again!',\n        });\n        // console.log(\n        //   'Sorry, there are no images matching your search query. Please, try again!'\n        // );\n        searchInput.value = ''; // clear input\n        drawGallery(myGallery, ''); // clear gallery\n      } else {\n        searchInput.value = ''; // clear input\n\n        galleryMarkdown = getGalleryMarkdown(images.hits);\n\n        drawGallery(myGallery, galleryMarkdown);\n        simpleLightBox.refresh();\n      }\n    })\n    .catch(error => {\n      console.error('сталося щось дивне', error);\n    });\n}\n\n// обробка інших помилок\nwindow.onerror = (message, source, lineno, colno, error) => {\n  // Обробляємо всі необроблені помилки\n  console.error('Unhandled error:', error);\n};\n"],"names":["getImages","searchTerm","queryUrl","getApiKey","response","error","getItemMarkdown","item","getGalleryMarkdown","images","drawGallery","gallery","markdown","iziCommon","iziError","iziWarning","loadMessageMarkdown","myGallery","searchButton","searchInput","simpleLightBox","SimpleLightbox","searchButtonHandler","event","galleryMarkdown","iziToast","message","source","lineno","colno"],"mappings":"uGAoBO,SAASA,EAAUC,EAAY,CAgBpC,MAAMC,EAAW,4BATC,IAAI,gBAAgB,CACpC,IAAKC,EAAW,EAEhB,EAAGF,EACH,WAAY,QACZ,YAAa,aACb,WAAY,EAChB,CAAG,CAEqD,GAEtD,OAAO,MAAMC,CAAQ,EAClB,KAAKE,GAAY,CAChB,GAAI,CAACA,EAAS,GACZ,MAAM,IAAI,MAAMA,EAAS,MAAM,EAEjC,OAAOA,EAAS,MACtB,CAAK,EACA,MAAMC,GAAS,QAAQ,IAAI,yBAA0BA,CAAK,CAAC,CAChE,CC9CA,SAASC,EAAgBC,EAAM,CAQ7B,MAAO;AAAA;AAAA,eAEMA,EAAK,aAAa;AAAA;AAAA;AAAA,eAGlBA,EAAK,YAAY;AAAA,eACjBA,EAAK,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA,qCAKaA,EAAK,KAAK;AAAA;AAAA;AAAA;AAAA,qCAIVA,EAAK,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA,qCAKVA,EAAK,QAAQ;AAAA;AAAA;AAAA;AAAA,qCAIbA,EAAK,SAAS;AAAA;AAAA;AAAA;AAAA,CAKnD,CAOO,SAASC,EAAmBC,EAAQ,CACzC,OAAOA,EAAO,IAAIH,CAAe,EAAE,KAAK,EAAE,CAC5C,CAOO,SAASI,EAAYC,EAASC,EAAU,CAC7CD,EAAQ,UAAYC,CACtB,CC7CA,MAAMC,EAAY,CAChB,QAAS,iBACT,MAAO,OACP,SAAU,WACV,WAAY,OACZ,UAAW,OACX,gBAAiB,MACjB,aAAc,OACd,YAAa,OACb,kBAAmB,MACnB,WAAY,EACd,EAEMC,EAAW,CACf,GAAGD,EACH,MAAO,UACP,QAAS,gBACX,EAEME,EAAa,CACjB,GAAGF,EACH,MAAO,UACP,MAAO,UACP,QAAS,kBACX,EAEMG,EACJ,+DACIC,EAAY,SAAS,cAAc,UAAU,EAC7CC,EAAe,SAAS,cAAc,gBAAgB,EACtDC,EAAc,SAAS,cAAc,eAAe,EACpDC,EAAiB,IAAIC,EAAe,aAAc,CACtD,aAAc,MACd,aAAc,IACd,eAAgB,EAClB,CAAC,EAEDH,EAAa,iBAAiB,QAASI,CAAmB,EAE1D,SAASA,EAAoBC,EAAO,CAClCA,EAAM,eAAc,EACpB,IAAItB,EAAa,OAAOkB,EAAY,MAAM,KAAM,CAAA,EAChDlB,EAAaA,EAAW,QAAQ,OAAQ,EAAE,EAC1C,IAAIuB,EAAkB,GAItB,GAAI,CAACvB,GAAcA,EAAW,OAAS,EAAG,CACxCwB,EAAS,QAAQ,CACf,GAAGV,EACH,QAAS,gDACf,CAAK,EAEDI,EAAY,MAAQ,GACpBT,EAAYO,EAAW,EAAE,EACzB,MACD,CAED,QAAQ,IAAI,6CAA6ChB,CAAU,EAAE,EACrES,EAAYO,EAAWD,CAAmB,EAQ1ChB,EAAUC,CAAU,EACjB,KAAKQ,GAAU,CACVA,EAAO,KAAK,SAAW,GACzBgB,EAAS,MAAM,CACb,GAAGX,EACH,QACE,+EACZ,CAAS,EAIDK,EAAY,MAAQ,GACpBT,EAAYO,EAAW,EAAE,IAEzBE,EAAY,MAAQ,GAEpBK,EAAkBhB,EAAmBC,EAAO,IAAI,EAEhDC,EAAYO,EAAWO,CAAe,EACtCJ,EAAe,QAAO,EAE9B,CAAK,EACA,MAAMf,GAAS,CACd,QAAQ,MAAM,qBAAsBA,CAAK,CAC/C,CAAK,CACL,CAGA,OAAO,QAAU,CAACqB,EAASC,EAAQC,EAAQC,EAAOxB,IAAU,CAE1D,QAAQ,MAAM,mBAAoBA,CAAK,CACzC"}